# Анализ оттока клиентов сети фитнес-центра с помощью машинного обучения

## Цели и задачи проекта

**Результат проекта:**
- в проекте получены данные клиентов фитнес-клуба для прогноза вероятности оттока клиентов;
- сделаны выводы о том, какие клиенты центра в зоне риска ухода;    
- найдены признаки поведения клиентов, коррелирующие с оттоком:
        - общий период взаимодействия к клубом (lifetime);
        - частота посещений в неделю;
        - возраст;
        - длительность текущего действующего абонемента.
- созданы 2 модели предсказания того, будет ли клиент продолжать пользоваться услугами клуба или покинет его (модель логистической регресии и модель случайного леса). Лучшую эффективность показала модель логистической регрессии. Наиболее сильными факторами являются: частота посещений в течение действующего абонемента, частота посещений в течение последнего месяца, общее количество месяцев пользование услугами клуба.
- выполнено разбиение клиентов клуба на 5 групп по особенностям взаимодействия с фитнес-клубом.

**Описание исходных данных**: 
данные клиентских анкет, представленные в виде csv-файла, содержащие данные на месяц до оттока и факт оттока на определённый месяц:
- персональные данные клиентов:
    - `gender` — пол;
    -`Near_Location` — факт проживания или работы в районе, где находится фитнес-центр;
    -`Partner` - является ли сотрудником компании-партнёра клуба;
    - `Promo_friends` - запись в клуб по причине участия в промо-акции;
    - `Phone` — наличие контактного телефона;
    - `Age` — возраст;
    - `Lifetime` — время с момента первого обращения в фитнес-центр (в месяцах);
- Информация на основе журнала посещений, покупок и информация о текущем статусе абонемента клиента:
    - `Contract_period` — длительность текущего действующего абонемента (месяц, 6 месяцев, год);
    - `Month_to_end_contract` — срок до окончания текущего действующего абонемента (в месяцах);
    - `Group_visits` — факт посещения групповых занятий;
    - `Avg_class_frequency_total` — средняя частота посещений в неделю за все время с начала действия абонемента;
    - `Avg_class_frequency_current_month` — средняя частота посещений в неделю за предыдущий месяц;
    - `Avg_additional_charges_total` — суммарная выручка от других услуг фитнес-центра: кафе, спорттовары, косметический и массажный салон.
- факт оттока в текущем месяце -`Churn`

**Цель проекта** - разработать на основе анализа клиентских анкет рекомендации для снижения оттока клиентов сети фитнес-центров.

**Задачи проекта:**
- спрогнозировать вероятность оттока (на уровне следующего месяца) для каждого клиента;
- сформировать типичные портреты клиентов: выделить несколько наиболее ярких групп и охарактеризовать их основные свойства;
- проанализировать основные признаки, наиболее сильно влияющие на отток;
- сформулировать основные выводы и разработать рекомендации по повышению качества работы с клиентами:
    - *выделить целевые группы клиентов*;
    - *предложить меры по снижению оттока*;
    - *определить другие особенности взаимодействия с клиентами*.

**Бизнес-задача**: увеличение LTV и прибыли сети фитнес-клубов.

**Тип задачи:** обучение с учителем, задача бинарной классификации.

**Предлагаемые алгоритмы обучения модели:**

- логистическая регрессия;
- случайный лес.


**Теги:**

предобработка данных, EDA, KMeans, MAchine Learning, дендрограмма, RandomForestClassifier, LogisticRegression, визуализация данных.


## Библиотеки

import pandas as pd

import numpy as np

import matplotlib.pyplot as plt

import seaborn as sns

import warnings

from sklearn.model_selection import train_test_split

from sklearn.linear_model import LogisticRegression

from sklearn.ensemble import RandomForestClassifier

from sklearn.metrics import accuracy_score, precision_score, recall_score, f1_score, roc_auc_score

from sklearn.model_selection import GridSearchCV

from sklearn.cluster import KMeans

from sklearn.preprocessing import StandardScaler

from scipy.cluster.hierarchy import dendrogram, linkage

import warnings

import sys

import random